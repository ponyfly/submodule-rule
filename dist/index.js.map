{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["const shell = require('shelljs')\nconst env = process.argv[2] || '--prod'\n\nfunction isTargetBranchMain (branchName) {\n  return shell.exec('git branch | grep \\\\* | cut -d \\' \\' -f2').indexOf(branchName) !== -1\n}\n\nfunction checkoutSubModuleBranchForDev (branchName) {\n  // eslint-disable-next-line\n  const submodulePath = shell.head({ '-n': 2 }, '.gitmodules').stdout.match(/path\\s*\\=\\s*(.+)/)[1]\n\n  shell.cd(submodulePath)\n\n  const branchListStr = shell.exec('git branch')\n  const currentSubmoduleBranchName = branchListStr.match(/\\*\\s(.+)\\b/)[1]\n  const hasSubmoduleBranchName = branchListStr.indexOf(branchName) !== -1\n\n  if (currentSubmoduleBranchName === branchName) {\n    shell.exec(`git pull`)\n  } else {\n    if (hasSubmoduleBranchName) {\n      shell.exec(`git checkout ${branchName} && git pull`)\n    } else {\n      shell.exec(`git checkout -b ${branchName} origin/${branchName}`)\n    }\n  }\n}\n\nfunction checkoutSubModuleBranchForProd () {\n  const isMasterMain = isTargetBranchMain('master')\n  if (!isMasterMain) {\n    shell.exec(\"git submodule foreach 'git checkout zelda'\")\n  }\n}\n\nexport default (function run () {\n  if (env === '--dev') {\n    const submoduleName = process.argv[3] || 'master'\n    checkoutSubModuleBranchForDev(submoduleName)\n  } else if (env === '--prod') {\n    checkoutSubModuleBranchForProd()\n  }\n})()\n"],"names":["shell","require","env","process","argv","isTargetBranchMain","branchName","exec","indexOf","checkoutSubModuleBranchForDev","submodulePath","head","stdout","match","cd","branchListStr","currentSubmoduleBranchName","hasSubmoduleBranchName","checkoutSubModuleBranchForProd","isMasterMain","run","submoduleName"],"mappings":";;;;;;EAAA,IAAMA,KAAK,GAAGC,OAAO,CAAC,SAAD,CAArB;;EACA,IAAMC,GAAG,GAAGC,OAAO,CAACC,IAAR,CAAa,CAAb,KAAmB,QAA/B;;EAEA,SAASC,kBAAT,CAA6BC,UAA7B,EAAyC;EACvC,SAAON,KAAK,CAACO,IAAN,CAAW,0CAAX,EAAuDC,OAAvD,CAA+DF,UAA/D,MAA+E,CAAC,CAAvF;EACD;;EAED,SAASG,6BAAT,CAAwCH,UAAxC,EAAoD;EAClD;EACA,MAAMI,aAAa,GAAGV,KAAK,CAACW,IAAN,CAAW;EAAE,UAAM;EAAR,GAAX,EAAwB,aAAxB,EAAuCC,MAAvC,CAA8CC,KAA9C,CAAoD,kBAApD,EAAwE,CAAxE,CAAtB;EAEAb,EAAAA,KAAK,CAACc,EAAN,CAASJ,aAAT;EAEA,MAAMK,aAAa,GAAGf,KAAK,CAACO,IAAN,CAAW,YAAX,CAAtB;EACA,MAAMS,0BAA0B,GAAGD,aAAa,CAACF,KAAd,CAAoB,YAApB,EAAkC,CAAlC,CAAnC;EACA,MAAMI,sBAAsB,GAAGF,aAAa,CAACP,OAAd,CAAsBF,UAAtB,MAAsC,CAAC,CAAtE;;EAEA,MAAIU,0BAA0B,KAAKV,UAAnC,EAA+C;EAC7CN,IAAAA,KAAK,CAACO,IAAN;EACD,GAFD,MAEO;EACL,QAAIU,sBAAJ,EAA4B;EAC1BjB,MAAAA,KAAK,CAACO,IAAN,wBAA2BD,UAA3B;EACD,KAFD,MAEO;EACLN,MAAAA,KAAK,CAACO,IAAN,2BAA8BD,UAA9B,qBAAmDA,UAAnD;EACD;EACF;EACF;;EAED,SAASY,8BAAT,GAA2C;EACzC,MAAMC,YAAY,GAAGd,kBAAkB,CAAC,QAAD,CAAvC;;EACA,MAAI,CAACc,YAAL,EAAmB;EACjBnB,IAAAA,KAAK,CAACO,IAAN,CAAW,4CAAX;EACD;EACF;;AAED,aAAe,CAAC,SAASa,GAAT,GAAgB;EAC9B,MAAIlB,GAAG,KAAK,OAAZ,EAAqB;EACnB,QAAMmB,aAAa,GAAGlB,OAAO,CAACC,IAAR,CAAa,CAAb,KAAmB,QAAzC;EACAK,IAAAA,6BAA6B,CAACY,aAAD,CAA7B;EACD,GAHD,MAGO,IAAInB,GAAG,KAAK,QAAZ,EAAsB;EAC3BgB,IAAAA,8BAA8B;EAC/B;EACF,CAPc,GAAf;;;;;;;;"}